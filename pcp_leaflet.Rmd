---
title: "Primary Care Provider Leaflet"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Leaflet Map

```{r pcp-leaflet-method-0}

# load libraries
library(leaflet)
library(tidyverse)
library(htmlwidgets)
library(fontawesome)
library(icons)


# make leaflet icons 
maine_icons_test <- awesomeIconList(
  `Doctor` = makeAwesomeIcon(icon = "fish", library = "fa", markerColor = "lightred"),
  `Family practice physician` = makeAwesomeIcon(icon = "fish", library = "fa", markerColor = "green"),
  `Medical clinic` = makeAwesomeIcon(icon = "fish", library = "fa", markerColor = "beige"),
  `Medical office` = makeAwesomeIcon(icon = "fish", library = "fa", markerColor = "blue"),
  `Medical group` = makeAwesomeIcon(icon = "fish", library = "fa", markerColor = "purple"),
  `Internist`  = makeAwesomeIcon(icon = "fish", library = "fa", markerColor = "orange"),
  `Medical cCenter` = makeAwesomeIcon(icon = "fish", library = "fa", markerColor = "lightred"),
  `Reproductive health clinic` = makeAwesomeIcon(icon = "heart", library = "fa", markerColor = "pink"),
  `Home health care service` = makeAwesomeIcon(icon = "fish", library = "fa", markerColor = "yellow"),
  `General practitioner` = makeAwesomeIcon(icon = "fish", library = "fa", markerColor = "beige"),
  `Hospital` = makeAwesomeIcon(icon = "fish", library = "fa", markerColor = "orange"),
  `Emergency care physician`  = makeAwesomeIcon(icon = "fish", library = "fa", markerColor = "purple"))  

maine_icons0 <- awesomeIconList(
  `Doctor` = makeAwesomeIcon(
  icon = "user-md",
  library = "fa",
  markerColor = "lightred"
),
  `Family practice physician` = makeAwesomeIcon(
  icon = "users",
  library = "fa",
  markerColor = "green"
),
  `Medical clinic` = makeAwesomeIcon(
  icon = "plus-square",
  library = "fa",
  markerColor = "beige"
),
  `Medical office` = makeAwesomeIcon(
  icon = "plus-square",
  library = "fa",
  markerColor = "blue"
),
  `Medical group` = makeAwesomeIcon(
  icon = "plus-square",
  library = "fa",
  markerColor = "purple"
),
  `Internist`  = makeAwesomeIcon(
  icon = "user-md",
  library = "fa",
  markerColor = "orange"
),
  `Medical Center` = makeAwesomeIcon(
  icon = "plus-square",
  library = "fa",
  markerColor = "lightred"
),
  `Reproductive health clinic` = makeAwesomeIcon(
  icon = "heart",
  library = "fa",
  markerColor = "pink"
),
  `Home health care service` = makeAwesomeIcon(
  icon = "user-md",
  library = "fa",
  markerColor = "yellow"
),
  `General practitioner` = makeAwesomeIcon(
  icon = "user-md",
  library = "fa",
  markerColor = "beige"
),
  `Hospital` = makeAwesomeIcon(
  icon = "h-square",
  library = "fa",
  markerColor = "orange"
),
  `Emergency care physician` = makeAwesomeIcon(
  icon = "medkit",
  library = "fa",
  markerColor = "purple"
)
)

# make popup text with name, address, notes, and link to website
pcp_df <-
  pcp_df %>% 
  mutate(full_website = paste("<b><a href='", website,"'>", title,"</a></b>", "<br/>", sep = "")) 

labels <- sprintf(
  "<strong>%s</strong><br/>Website: %s<br/>Rating out of 5: %s",
  pcp_df$title, pcp_df$full_website, pcp_df$rating
) %>% lapply(htmltools::HTML)

# setup basemap
pcp_leaflet <- 
  leaflet() %>% 
  addTiles() %>%
  addMarkers(~pcp_df$longitude, 
             ~pcp_df$latitude, 
             data = pcp_df, 
             group = pcp_df$category, 
             popup = ~labels)
  

pcp_leaflet <- 
      leaflet(data = pcp_df) %>%
      addTiles() %>% addAwesomeMarkers(
      ~longitude,
      ~latitude,
      popup = ~labels,
      icon = ~maine_icons0[category], 
      group = ~category)



icon1 <- makeAwesomeIcon(
  icon = "medkit",
  library = "fa",
  markerColor = "beige"
)
# add layer controls to map 
pcp_leaflet <- 
  pcp_leaflet %>% 
  addLayersControl(
    overlayGroups = pcp_df$category,
    options = layersControlOptions(collapsed = FALSE)
  )

# save widget 
saveWidget(pcp_leaflet, "maine_pcp.html")

# pcp_leaflet

```


